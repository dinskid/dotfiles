DATA SEGMENT
N DB 22
LOOKUP DB '0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'
HEX DB 3 DUP('$')
BINARY DB 33 DUP('$')
GRAY DB 33 DUP('$')
NEWL DB 0AH, 0DH, '$'
DATA ENDS

PRINT MACRO ; si: address of string
	LOCAL LOOP1, ENDLOOP1, LOOP2
	PUSH SI
	MOV DI, SI
	XOR CX, CX
	XOR AH, AH
	LOOP1:
		LODSB
		CMP AL, '$'
		JE ENDLOOP1
		INC CX
		PUSH AX
		JMP LOOP1
	ENDLOOP1:
	LOOP2:
		POP AX
		STOSB
		LOOP LOOP2
	POP DX
	MOV AH, 09H
	INT 21H
	LEA DX, NEWL
	MOV AH, 09H
	INT 21H
ENDM

CONVERT MACRO ANDAMT, SHAMT ; di: address of string, dl: n
	LOCAL MOO, ENDMOO
	XOR DH, DH
	XOR CX, CX
	MOO:
		CMP DX, 0
		JZ ENDMOO
		MOV SI, DX
		AND SI, ANDAMT
		ADD SI, OFFSET LOOKUP
		MOVSB
		INC CX
		SHR DX, SHAMT
		JMP MOO
	ENDMOO:
ENDM

CODE SEGMENT
ASSUME CS:CODE, DS:DATA, ES:DATA, SS:DATA

START:
MOV AX, DATA
MOV DS, AX
MOV ES, AX
MOV SS, AX

LEA DI, BINARY
MOV DL, N
CONVERT 1, 1
LEA SI, BINARY
PRINT

MOV DL, N
LEA DI, HEX
CONVERT 15, 4
LEA SI, HEX
PRINT

LEA DI, GRAY
MOV DL, N
MOV DH, N
SHR DH, 1
XOR DL, DH
CONVERT 1, 1
LEA SI, GRAY
PRINT

MOV AH, 4CH
INT 21H
CODE ENDS
END START

